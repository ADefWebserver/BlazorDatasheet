@using System.Text
@using BlazorDatasheet.Data

@if (SelectionRange != null && !Hidden)
{
    <div class="selection-base" style="@GetSizeStyleString()"/>
}


<style>
    .selection-base{
        position: absolute;
        border: 2px solid #0998e5;
        background: rgba(117,183,229,0.13);
        pointer-events: none;
    }
</style>

@code {

    [Parameter, EditorRequired]
    public double ColumnWidth { get; set; }

    [Parameter, EditorRequired]
    public double RowHeight { get; set; }

    [Parameter, EditorRequired]
    public IFixedSizeRange SelectionRange { get; set; }

    [Parameter, EditorRequired]
    public bool HasColumnHeaders { get; set; }

    [Parameter, EditorRequired]
    public bool HasRowHeaders { get; set; }

    [Parameter, EditorRequired]
    public bool Hidden { get; set; }

    private string GetSizeStyleString()
    {
        if (SelectionRange == null)
            return "";
        var strBuilder = new StringBuilder();

        var extraCols = HasRowHeaders ? 1 : 0;
        var extraRows = HasColumnHeaders ? 1 : 0;

        var left = (ColumnWidth) * (SelectionRange.StartPosition.Col + extraCols) - 1;
        var top = (RowHeight) * (SelectionRange.StartPosition.Row + extraRows) - 1;

        strBuilder.Append($"left:{left}px;");
        strBuilder.Append($"top:{top}px;");
        strBuilder.Append($"width:{SelectionRange.Width * ColumnWidth + 3}px;");
        strBuilder.Append($"height:{SelectionRange.Height * RowHeight + 3}px;");
        return strBuilder.ToString();
    }

}