@using BlazorDatasheet.Model
@implements ICellEditor

@code {

    [Parameter]
    public EditState EditState { get; set; }

    public void BeginEdit(EditEntryMode entryMode, Cell cell, string key)
    {
        EditState.CanAcceptEdit = true;
        EditState.CanCancelEdit = true;

        var canPass = bool.TryParse(cell.Value, out bool parsedValue);
        if (!canPass)
            EditState.OnCancelEdit.Invoke();

        EditState.EditString = cell.Value;

        if (entryMode == EditEntryMode.Mouse)
        {
            var newValue = !parsedValue;
            EditState.EditString = newValue.ToString();
        }

        if (entryMode == EditEntryMode.Key)
        {
            if (key.ToLower() == "y")
            {
                EditState.EditString = true.ToString();
            }
            else if (key.ToLower() == "n")
            {
                EditState.EditString = false.ToString();
            }
            else if (key == "Space")
            {
                EditState.EditString = (!parsedValue).ToString();
            }
        }

        EditState.OnAcceptEdit.Invoke();
    }

    public bool HandleKey(string key)
    {
        return false;
    }

}